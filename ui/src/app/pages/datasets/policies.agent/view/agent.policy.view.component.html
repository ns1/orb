<header class="row" data-orb-qa-id="agent#view">
  <div class="col-7">
    <xng-breadcrumb
      class="orb-breadcrumb"
      data-orb-qa-id="breadcrumb"
    ></xng-breadcrumb>

    <h4>Policy View</h4>
  </div>
  <div class="col-5">
    <div class="right-content">
      <button nbButton ghost [className]="'refresh-button'" shape="round" (click)="fetchData()">
        <i class="fa fa-redo" [ngClass]="isLoading == true ? 'rotate' : 'paused'" style="color: #3089fc;"></i>
      </button>
      <span class="last-update" *ngIf="lastUpdate !== null" style="margin-top: 8px; margin-right: 15px;">
        Last Update: {{ lastUpdate | date: 'HH:mm:ss a' }}
      </span>
      <div *ngIf="!isLoading" >
        <button (click)="discard()" class="policy-discard" nbButton shape="round" *ngIf="isEditMode()">
          Discard Changes
        </button>
        <button (click)="save()" [disabled]="!canSave()" class="policy-save" nbButton *ngIf="isEditMode()" shape="round">
          <nb-icon icon="save-outline"></nb-icon>
          Save Changes
        </button>
        <button (click)="onOpenDuplicatePolicy()" class="policy-duplicate" data-orb-qa-id="button#reset" nbButton shape="round" *ngIf="!isEditMode()">
          <nb-icon icon="copy-outline"></nb-icon>
          Duplicate Policy
        </button>
        <button (click)="openDeleteModal()" class="card-button delete-button" data-orb-qa-id="button#reset" nbButton shape="round" *ngIf="!isEditMode()"
        style="color: #df316f !important;">
          <nb-icon icon="trash-2-outline"></nb-icon>
          Delete Policy
        </button>
      </div>
    </div>
  </div>
</header>

<div *ngIf="!isLoading" class="row" #content>
  <div class="card-col col-4">
    <ngx-policy-details
      [(editMode)]="editMode.details"
      [policy]="policy"
    ></ngx-policy-details>
    <ngx-policy-groups [groups]="policy.groups" [policy]="policy"></ngx-policy-groups>
  </div>
  <div class="card-col col-8">
    <ngx-policy-datasets
      (refreshPolicy)="retrievePolicy()"
      [datasets]="datasets"
      [policy]="policy"
    ></ngx-policy-datasets>
    <ngx-policy-interface
      [(editMode)]="editMode.interface"
      [policy]="policy"
    ></ngx-policy-interface>
  </div>
</div>
