<div class="filter-div"> 
  <div
    class="filter-button" 
    (click)="onFilterClick()"
  >
    <span>Filter by</span>
    <nb-icon icon="chevron-down-outline" class="icon"></nb-icon>
  </div>

  <div id="filterMenu" class="filter-menu" *ngIf="showMenu">
    <button 
      id="filterMenu"
      class="filter-menu-item" 
      *ngFor="let option of availableFilters"
      (click)="handleFilterOptionClick(option)"
    >
      <span>{{ option.name }}</span>
    </button>
  </div>
</div>

<div class="apply-filter-div" *ngIf="currentFilter !== null">
  <input type="text"
    id="filterInput"
    class="apply-filter-input"
    nbInput
    placeholder="{{currentFilter.name}}"
    [readonly]="currentFilter?.options"
    [(ngModel)]="filterText"
    (click)="showOptions = true"
    [class.pointer-cursor]="currentFilter?.options"
    autofocus
  >
  <button 
    *ngIf="!currentFilter?.options"
    class="add-filter-button"
    [disabled]="!filterText"
    nbTooltip="Add Filter"
    (click)="onAddFilterButton(filterText)"
  >
    <nb-icon icon="plus-outline"></nb-icon>
  </button>
  <div class="filter-menu" *ngIf="currentFilter?.options && showOptions">
    <div 
      *ngFor="let option of currentFilter?.options" 
      class="apply-filter-option"
      (click)="handleClickMultiSelect($event, option)"
    >
      <input type="checkbox" 
        (click)="onCheckboxMultiSelect($event, option)"            
      >
      <span>{{ option | titlecase }}</span>
    </div>
  </div>
  <div class="filter-menu" *ngIf="!currentFilter?.options && showOptions">
    <div 
      *ngFor="let option of currentFilter?.autoSuggestion | async" 
      class="apply-filter-option"
      (click)="applyFilter($event, option)"
    > 
      <input type="checkbox" 
        (click)="onCheckboxApply($event, option)"
        [checked]="isOptionSelected(option) | async"            
      >
      <span>{{ option }}</span>
    </div>
  </div>
</div>

<div class="search-input-wrapper">
  <nb-icon icon="search-outline" class="search-icon"></nb-icon>
  <input type="text" 
    placeholder="Search by name" 
    [(ngModel)]="searchText"
    nbInput
    class="search-input"
    (ngModelChange)="onSearchTextChange()">
</div>

<mat-chip-list>
  <ng-container *ngFor="let filter of activeFilters$ | async; let index = index">
    <mat-chip *ngIf="filter.name !== 'Name'" class="filter-chip">
      {{ filter?.exact ? filter.name + ": '" + filter?.param + "'" : filter.name + ': ' + filter?.param }}
      <button class="remove-tag-button" (click)="removeFilter(index)" nbButton shape="round" id="remove-button">
        <i class="fa fa-window-close" style="color: #3089fc;">&nbsp;</i>
      </button>
    </mat-chip>
  </ng-container>
</mat-chip-list>

